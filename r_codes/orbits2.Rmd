---
title: "Orbits again!"
author: "Emilio Miralles"
date: "2023-07-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(r2d3)
```

[Last time](./orbits.html) we solved the motion of two bodies numerically from an *inertial* reference frame.

Now we introduce the notion of the center of mass or *barycenter* of the system, which is just a sort of weighted average of the positions.

$$
{\bf R}_\mathrm{COG} = \frac{m_1 {\bf r}_1 + m_2 {\bf r}_2}{m_1 + m_2}
$$

It follows that the velocity and acceleration are:

$$
\begin{align}
{\bf \dot{R}}_\mathrm{COG} &= \frac{m_1 {\bf \dot{r}}_1 + m_2 {\bf \dot{r}}_2}{m_1 + m_2} \\
{\bf \ddot{R}}_\mathrm{COG} &= \frac{m_1 {\bf \ddot{r}}_1 + m_2 {\bf \ddot{r}}_2}{m_1 + m_2} \\
\end{align}
$$

Since the only force we consider here is the gravitational attraction between the masses, we found previously that ${\bf F}_{1} = -{\bf F}_{2}$, so substituting ${\bf F}_i = m {\bf \ddot{r}}_i$:

$$
m_1 {\bf \ddot{r}}_1 + m_2 {\bf \ddot{r}}_2 = 0
$$

So we see that ${\bf \ddot{R}}_\mathrm{COG} = 0$, i.e. the barycenter is not accelerating, and is therefore an inertial reference frame.

## Example

```{r}
m_1 <- 1.0e26
m_2 <- 5.0e25
R_1 <- c(100, 120)
R_2 <- c(150, 50)
R_COG <- (m_1*R_1 + m_2*R_2) / (m_1 + m_2)
```

```{r}
df      <- data.frame(m=m_1, x=R_1[1], y=R_1[2])
df[2, ] <- data.frame(m=m_2, x=R_2[1], y=R_2[2])
```

```{d3 data=df, echo=FALSE}
// Arrow marker
svg.append("svg:defs").append("svg:marker")
    .attr("id", "triangle")
    .attr("refX", 10)
    .attr("refY", 4)
    .attr("markerWidth", 10)
    .attr("markerHeight", 10)
    .attr("markerUnits","userSpaceOnUse")
    .attr("orient", "auto")
    .append("path")
    .attr("d", "M 0 0 L 0 8 L 10 4 L 0 0")
    .attr("fill", "black");

// Axes
var yOffset = `translate(${height/2}, 0)`;
var xOffset = `translate(0, ${height/2})`;
var xyOffset = `translate(${height/2}, ${height/2})`;

var maxMass = Math.max(...data.map(({ m }) => m))

var x = d3.scaleLinear()
    .domain([-height/2, height/2])
    .range([0, height]);
var y = d3.scaleLinear()
    .domain([height/2, -height/2])
    .range([0, height]);

var yAxis = g => g
    .attr("transform", yOffset)
    .call(d3.axisLeft(y).ticks(5));
var xAxis = g => g
    .attr("transform", xOffset)
    .call(d3.axisBottom(x).ticks(5));

// Image
svg.append("g").call(yAxis);
svg.append("g").call(xAxis);

svg.append("g")
  .attr("transform", xyOffset)
    .selectAll("circle")
    .data(data)
    .enter().append("circle")
        .attr("id", function(d, i) { return i; })
        .attr("r", function(d) { return d.m / maxMass * 6; })
        .attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return -d.y; })
        .attr("fill", "black");
```

```{r echo=FALSE, fig.height=2, out.width="50%"}
r2d3(script="./scripts/rcog.js")
```

## Links

- [Index](./index.html)
