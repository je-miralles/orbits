---
title: "Orbits again!"
author: "Emilio Miralles"
date: "2023-07-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(r2d3)
```

Last time we solved the motion of two bodies numerically from an *inertial* reference frame.

Now we introduce the notion of the center of mass or *barycenter* of the system, which is just a sort of weighted average of the positions.

$$
{\bf R}_\mathrm{COG} = \frac{m_1 {\bf R}_1 + m_2 {\bf R}_2}{m_1 + m_2}
$$

It follows that the velocity and acceleration are:

$$
\begin{align}
{\bf \dot{R}}_\mathrm{COG} &= \frac{m_1 {\bf \dot{R}}_1 + m_2 {\bf \dot{R}}_2}{m_1 + m_2} \\
{\bf \ddot{R}}_\mathrm{COG} &= \frac{m_1 {\bf \ddot{R}}_1 + m_2 {\bf \ddot{R}}_2}{m_1 + m_2} \\
\end{align}
$$

Since the only force we consider here is the gravitational attraction between the masses, we found previously that ${\bf F}_{12} = -{\bf F}_{21}$, so substituting ${\bf F} = m {\bf \ddot{r}}$:

$$
m_1 {\bf \ddot{R}}_1 + m_2 {\bf \ddot{R}}_2 = 0
$$

So we see that {${\bf \ddot{R}}_\mathrm{COG} = 0$}, i.e. the barycenter is not accelerating, and is therefore an inertial reference frame.

## Figs

```{d3 echo=FALSE, out.width = "50%"}
var pathString = (x0, y0, x1, y1) => {
  const path = d3.path();
  path.moveTo(x0, y0);
  path.lineTo(x1, y1);
  return path.toString(); // eg. "M40,0A40,40,0,1,1,-40,0A40,40,0,1,1,40,0"
}

var margin = ({top: 0, right: 0, bottom: 0, left: 0});

var xRange = margin.left + (height - margin.bottom)/2;
var yRange = margin.top + (height - margin.bottom - margin.top)/2;

var yOffset = `translate(${xRange}, 0)`;
var xOffset = `translate(0, ${yRange})`;
var xyOffset = `translate(${xRange}, ${yRange})`;


var x = d3.scaleLinear()
    .domain([-(height - margin.bottom)/2, (height - margin.bottom)/2])
    .range([margin.left, margin.left + (height - margin.bottom)]);
var y = d3.scaleLinear()
    .domain([-(height - margin.bottom)/2, (height - margin.bottom)/2])
    .range([height - margin.bottom, margin.top]);

var yAxis = g => g
    .attr("transform", yOffset)
    .call(d3.axisLeft(y).ticks(5));
var xAxis = g => g
    .attr("transform", xOffset)
    .call(d3.axisBottom(x).ticks(5));

svg.append("g")
    .call(yAxis);
svg.append("g")
    .call(xAxis);

svg.append("svg:defs").append("svg:marker")
    .attr("id", "triangle")
    .attr("refX", 10)
    .attr("refY", 4)
    .attr("markerWidth", 10)
    .attr("markerHeight", 10)
    .attr("markerUnits","userSpaceOnUse")
    .attr("orient", "auto")
    .append("path")
    .attr("d", "M 0 0 L 0 8 L 10 4 L 0 0")
    .style("fill", "black");

var vec = (g, id, x1, y1, x2, y2) => g
    .attr("transform", xyOffset)
    .append("path")
    .attr("id", id)
    .attr("fill", "black")
    .attr("stroke", "black")
    .attr("stroke-width", 1)
    .attr("d", pathString(x1,y1,x2,y2))
    .attr("marker-end", "url(#triangle)")

var vecText = (g, id) => g
    .attr("transform", `translate(${xRange}, ${yRange})`)
    .append("text")
    .attr("text-anchor", "middle")
    .attr("dy", "1em")
    .append("textPath")
    .attr("xlink:href", '#' + id)
    .attr("startOffset", "75%")
    .text(id);

svg.append("g")
    .call(vec, "R1", 0, 0, 100, -50);
svg.append("g")
    .call(vecText, "R1");

svg.append("g")
    .call(vec, "R2", 0, 0, 120, -25);
svg.append("g")
    .call(vecText, "R2");
```
